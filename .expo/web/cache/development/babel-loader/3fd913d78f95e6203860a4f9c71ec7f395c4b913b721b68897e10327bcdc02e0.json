{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport { ScrollViewBase } from \"react-native-web/dist/index\";\nimport { getDatabase, onValue, off, push, get, set, remove } from \"firebase/database\";\nimport { NavigationContainer, useNavigation, useRoute } from '@react-navigation/native';\nimport { createNativeStackNavigator } from '@react-navigation/native-stack';\nimport { FirebaseApp, initializeApp } from \"firebase/app\";\nimport { ref as sRef } from \"firebase/database\";\nimport { Modal, Portal, Button as PaperButton } from 'react-native-paper';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function App(_ref) {\n  var nombre = _ref.nombre;\n  var _useState = useState('10%'),\n    _useState2 = _slicedToArray(_useState, 2),\n    altura = _useState2[0],\n    setAltura = _useState2[1];\n  var _useState3 = useState('none'),\n    _useState4 = _slicedToArray(_useState3, 2),\n    display = _useState4[0],\n    setDisplay = _useState4[1];\n  var _useState5 = useState('▲'),\n    _useState6 = _slicedToArray(_useState5, 2),\n    flecha = _useState6[0],\n    setFlecha = _useState6[1];\n  var _useState7 = useState(null),\n    _useState8 = _slicedToArray(_useState7, 2),\n    pedido = _useState8[0],\n    setPedido = _useState8[1];\n  return _jsx(NavigationContainer, {\n    independent: true,\n    children: _jsxs(Stack.Navigator, {\n      children: [_jsx(Stack.Screen, {\n        name: \"TableS\",\n        component: MozoPage,\n        options: {\n          headerShown: false\n        },\n        initialParams: {\n          nombre: nombre\n        }\n      }), _jsx(Stack.Screen, {\n        name: \"elegirmenu\",\n        component: ElegirMenu,\n        options: {\n          headerShown: false\n        }\n      }), _jsx(Stack.Screen, {\n        name: \"subcategoria\",\n        component: Subcategoria,\n        options: {\n          headerShown: false\n        }\n      })]\n    })\n  });\n}\nvar firebaseConfig = {\n  apiKey: \"AIzaSyBZoCJQgmwqXltZbBWmkZ54stBlT6jf4Gs\",\n  authDomain: \"restoapp-2e79a.firebaseapp.com\",\n  databaseURL: \"https://restoapp-2e79a-default-rtdb.firebaseio.com\",\n  projectId: \"restoapp-2e79a\",\n  storageBucket: \"restoapp-2e79a.appspot.com\",\n  messagingSenderId: \"300896535259\",\n  appId: \"1:300896535259:web:33f41bd2627b410064c2fe\",\n  measurementId: \"G-X9RC5LH6MK\"\n};\nvar app = initializeApp(firebaseConfig);\nvar database = getDatabase(app);\nvar Stack = createNativeStackNavigator();\nfunction MozoPage() {\n  var infoRef = sRef(database, 'info');\n  var _useState9 = useState([]),\n    _useState10 = _slicedToArray(_useState9, 2),\n    mesas = _useState10[0],\n    setMesas = _useState10[1];\n  var _useState11 = useState(null),\n    _useState12 = _slicedToArray(_useState11, 2),\n    cantidadmesas = _useState12[0],\n    setCantidadMesas = _useState12[1];\n  var navigation = useNavigation();\n  var route = useRoute();\n  var nombre = route.params.nombre;\n  useEffect(function () {\n    var unsubscribe = onValue(infoRef, function (snapshot) {\n      if (snapshot.exists()) {\n        var data = snapshot.val();\n        var infoItems = Object.values(data);\n        var _cantidadmesas = infoItems[0];\n        setMesas(new Array(_cantidadmesas).fill(null));\n        setCantidadMesas(_cantidadmesas);\n      } else {\n        setMesas([]);\n      }\n    }, []);\n  }, []);\n  var handleMesaPress = function handleMesaPress(mesaNumber) {\n    navigation.navigate('elegirmenu', {\n      mesaNumber: mesaNumber,\n      nombre: nombre\n    });\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsx(View, {\n      style: styles.container,\n      children: _jsx(Text, {\n        style: styles.title,\n        children: \"Seleccione una mesa:\"\n      })\n    }), _jsx(ScrollView, {\n      contentContainerStyle: styles.mesas,\n      children: cantidadmesas !== null && mesas.map(function (_, index) {\n        return _jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return handleMesaPress(index + 1);\n          },\n          style: styles.botontable,\n          children: _jsxs(Text, {\n            children: [\"Mesa \", index + 1]\n          })\n        }, index);\n      })\n    })]\n  });\n}\nfunction ElegirMenu() {\n  var route = useRoute();\n  var nombre = route.params.nombre;\n  var menu = sRef(database);\n  var navigation = useNavigation();\n  var _useState13 = useState([]),\n    _useState14 = _slicedToArray(_useState13, 2),\n    subcategorias = _useState14[0],\n    setSubcategorias = _useState14[1];\n  var comidaRef = sRef(getDatabase(), 'Comida');\n  var _useState15 = useState([]),\n    _useState16 = _slicedToArray(_useState15, 2),\n    elementosNoEnviados = _useState16[0],\n    setElementosNoEnviados = _useState16[1];\n  var _useState17 = useState([]),\n    _useState18 = _slicedToArray(_useState17, 2),\n    elementosEnviados = _useState18[0],\n    setElementosEnviados = _useState18[1];\n  useEffect(function () {\n    onValue(carrito, function (snapshot) {\n      if (snapshot.exists()) {\n        var _pedido = snapshot.val();\n        var elementos = Object.values(_pedido);\n        var _elementosNoEnviados = elementos.filter(function (elemento) {\n          return !elemento.enviado;\n        });\n        var _elementosEnviados = elementos.filter(function (elemento) {\n          return elemento.enviado;\n        });\n        setElementosNoEnviados(_elementosNoEnviados);\n        setElementosEnviados(_elementosEnviados);\n      } else {\n        setElementosNoEnviados([]);\n        setElementosEnviados([]);\n      }\n    });\n  }, []);\n  useEffect(function () {\n    var unsubscrib = onValue(comidaRef, function (snapshot) {\n      if (snapshot.exists()) {\n        var data = snapshot.val();\n        var subcategoriasArray = Object.keys(data);\n        setSubcategorias(subcategoriasArray);\n      } else {\n        setSubcategorias([]);\n      }\n    });\n  }, []);\n  var mesaNumber = route.params.mesaNumber;\n  var nombreCategoriaCarrito = \"Carritos/\" + `CarritoMesa${mesaNumber}`;\n  var carrito = sRef(database, nombreCategoriaCarrito);\n  useEffect(function () {\n    onValue(carrito, function (snapshot) {\n      if (snapshot.exists()) {\n        var _pedido2 = snapshot.val();\n        setPedido(_pedido2);\n      } else {\n        setPedido(null);\n      }\n    });\n  }, []);\n  var EnviarAlChef = function EnviarAlChef() {\n    var nombreCategoriaCarrito = \"Carritos/\" + `CarritoMesa${mesaNumber}`;\n    var carrito = sRef(database, nombreCategoriaCarrito);\n    get(carrito).then(function (snapshot) {\n      if (snapshot.exists()) {\n        var carritoPendiente = snapshot.val();\n        if (Array.isArray(carritoPendiente)) {\n          var elementosPendientes = carritoPendiente.filter(function (elemento) {\n            return !elemento.enviado;\n          });\n          if (elementosPendientes.length > 0) {\n            EnviarElementosAlChef(elementosPendientes);\n            var carritoActualizado = carritoPendiente.map(function (elemento) {\n              if (elementosPendientes.some(function (enviado) {\n                return enviado.id === elemento.id;\n              })) {\n                return _objectSpread(_objectSpread({}, elemento), {}, {\n                  enviado: true\n                });\n              }\n              return elemento;\n            });\n            set(carrito, carritoActualizado).then(function () {}).catch(function (error) {\n              console.error('Error al actualizar el carrito:', error);\n            });\n          } else {}\n        } else {\n          console.error('El carrito pendiente no es un array válido.');\n        }\n      } else {}\n    });\n  };\n  var agruparElementosPorNombreYVariante = function agruparElementosPorNombreYVariante(elementos) {\n    var agrupados = {};\n    elementos.forEach(function (elemento) {\n      var key = `${elemento.nombre}-${elemento.variante || ''}`;\n      if (agrupados[key]) {\n        agrupados[key].cantidad++;\n      } else {\n        agrupados[key] = _objectSpread(_objectSpread({}, elemento), {}, {\n          cantidad: 1\n        });\n      }\n    });\n    return Object.values(agrupados);\n  };\n  var EnviarElementosAlChef = function EnviarElementosAlChef(elementosPendientes) {\n    var chefRef = sRef(getDatabase(), 'comandas');\n    var pedidoAlChef = {\n      elementos: elementosPendientes,\n      mesa: mesaNumber,\n      hora: new Date().toISOString()\n    };\n    push(chefRef, pedidoAlChef).then(function () {}).catch(function (error) {\n      console.error('Error al enviar el pedido al chef:', error);\n    });\n  };\n  var cerrarMesa = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      var carritoSnapshot = yield get(carrito);\n      if (carritoSnapshot.exists()) {\n        var carritoData = carritoSnapshot.val();\n        try {\n          yield remove(carrito);\n        } catch (error) {\n          console.error('Error al cerrar el carrito:', error);\n        }\n        var mesascerradasRef = sRef(database, \"Mesascerradas/\" + `Mesa${mesaNumber}cerrada`);\n        var mesacerrada = {\n          mozo: nombre,\n          mesa: mesaNumber,\n          carrito: carritoData\n        };\n        push(mesascerradasRef, mesacerrada);\n        var contadorRef = sRef(database, 'Infomozos/' + `Mesascerradas${nombre}`);\n        try {\n          var contadorSnapshot = yield get(contadorRef);\n          var contadorActual = contadorSnapshot.val() || 0;\n          yield set(contadorRef, contadorActual + 1);\n        } catch (error) {\n          console.error('Error al actualizar el contador de mesas cerradas:', error);\n        }\n      } else {}\n    });\n    return function cerrarMesa() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  function desplegar() {\n    if (altura < '20%') {\n      setAltura('60%');\n      setDisplay(\"flex\");\n      setFlecha(\"▼\");\n    } else {\n      setAltura('10%');\n      setDisplay(\"none\");\n      setFlecha(\"▲\");\n    }\n  }\n  return _jsxs(View, {\n    style: {\n      backgroundColor: \"white\",\n      height: \"100%\"\n    },\n    children: [_jsxs(View, {\n      style: styles.container,\n      children: [_jsxs(Text, {\n        style: styles.title,\n        children: [\"Pedido de la mesa \", mesaNumber]\n      }), _jsx(Text, {\n        children: \"Menu:\"\n      })]\n    }), _jsx(ScrollView, {\n      contentContainerStyle: styles.mesas,\n      children: subcategorias.map(function (subcategoria, index) {\n        return _jsx(TouchableOpacity, {\n          style: styles.boton,\n          onPress: function onPress() {\n            navigation.navigate('subcategoria', {\n              subcategoria: subcategoria,\n              mesaNumber: mesaNumber,\n              nombre: nombre,\n              elementosEnviados: elementosEnviados,\n              elementosNoEnviados: elementosNoEnviados,\n              pedido: pedido,\n              setPedido: setPedido\n            });\n          },\n          children: _jsx(Text, {\n            style: styles.botontext,\n            children: subcategoria\n          })\n        }, index);\n      })\n    }), _jsxs(View, {\n      style: {\n        height: altura,\n        backgroundColor: '#6CADFC',\n        alignContent: 'center'\n      },\n      children: [_jsxs(Text, {\n        id: \"desplegame\",\n        style: styles.title,\n        onPress: function onPress() {\n          return desplegar();\n        },\n        children: [flecha, \" Orden de la mesa \", flecha]\n      }), _jsxs(View, {\n        style: {\n          display: display\n        },\n        children: [_jsx(Text, {\n          style: {\n            textAlign: \"center\",\n            fontSize: 24,\n            fontWeight: 'bold',\n            marginBottom: 20\n          },\n          children: pedido ? 'Pedido:' : 'El pedido está vacío'\n        }), _jsxs(ScrollView, {\n          style: {\n            height: '30%'\n          },\n          children: [agruparElementosPorNombreYVariante(elementosEnviados).map(function (item, index) {\n            return _jsxs(Text, {\n              style: {\n                textAlign: 'center',\n                backgroundColor: '#6CFC7B'\n              },\n              children: [item.nombre, item.variante ? `${item.variante}` : '', \" X\", item.cantidad]\n            }, index);\n          }), agruparElementosPorNombreYVariante(elementosNoEnviados).map(function (item, index) {\n            return _jsxs(Text, {\n              style: {\n                textAlign: 'center',\n                backgroundColor: '#FC6C6C'\n              },\n              children: [item.nombre, item.variante ? `${item.variante}` : '', \" X\", item.cantidad]\n            }, index);\n          })]\n        }), _jsxs(View, {\n          style: {\n            alignItems: \"center\"\n          },\n          children: [_jsx(TouchableOpacity, {\n            onPress: function onPress() {\n              return EnviarAlChef();\n            },\n            style: {\n              backgroundColor: 'white',\n              width: \"30%\",\n              height: \"20%\",\n              borderRadius: \"15\",\n              justifyContent: \"center\",\n              marginTop: \"5%\"\n            },\n            children: _jsx(Text, {\n              style: {\n                textAlign: \"center\"\n              },\n              children: \"Enviar\"\n            })\n          }), _jsx(TouchableOpacity, {\n            onPress: function onPress() {\n              return cerrarMesa(nombre, mesaNumber);\n            },\n            style: {\n              backgroundColor: 'white',\n              width: \"30%\",\n              height: \"22%\",\n              borderRadius: \"15\",\n              justifyContent: \"center\",\n              marginTop: \"5%\"\n            },\n            children: _jsx(Text, {\n              style: {\n                textAlign: \"center\"\n              },\n              children: \"Cerrar la mesa\"\n            })\n          })]\n        })]\n      })]\n    })]\n  });\n}\nfunction Subcategoria(_ref3) {\n  var route = _ref3.route;\n  var _route$params = route.params,\n    subcategoria = _route$params.subcategoria,\n    mesaNumber = _route$params.mesaNumber,\n    nombre = _route$params.nombre,\n    elementosEnviados = _route$params.elementosEnviados,\n    elementosNoEnviados = _route$params.elementosNoEnviados;\n  var _useState19 = useState([]),\n    _useState20 = _slicedToArray(_useState19, 2),\n    menuItems = _useState20[0],\n    setMenuItems = _useState20[1];\n  var _useState21 = useState(false),\n    _useState22 = _slicedToArray(_useState21, 2),\n    showOptionsModal = _useState22[0],\n    setShowOptionsModal = _useState22[1];\n  var _useState23 = useState(null),\n    _useState24 = _slicedToArray(_useState23, 2),\n    selectedItem = _useState24[0],\n    setSelectedItem = _useState24[1];\n  useEffect(function () {\n    var subcategoriaRef = sRef(getDatabase(), 'Comida/' + subcategoria);\n    var unsubscribe = onValue(subcategoriaRef, function (snapshot) {\n      if (snapshot.exists()) {\n        var data = snapshot.val();\n        var elementos = Object.keys(data).map(function (key) {\n          return _objectSpread({\n            id: key\n          }, data[key]);\n        });\n        setMenuItems(elementos);\n      } else {\n        setMenuItems([]);\n      }\n    });\n    return function () {\n      unsubscribe();\n    };\n  }, [subcategoria]);\n  var AgregarAlCarrito = function AgregarAlCarrito(item) {\n    if (item.opciones) {\n      setSelectedItem(item);\n      setShowOptionsModal(true);\n    } else {\n      var nombreCategoriaCarrito = \"Carritos/\" + `CarritoMesa${mesaNumber}`;\n      var _carrito = sRef(database, nombreCategoriaCarrito);\n      onValue(_carrito, function (snapshot) {\n        if (snapshot.exists()) {\n          var _pedido3 = snapshot.val();\n          setPedido(_pedido3);\n        } else {\n          setPedido(null);\n        }\n      });\n      var newItem = {\n        nombre: item.nombre,\n        precio: item.precio\n      };\n      get(_carrito).then(function (snapshot) {\n        if (snapshot.exists()) {\n          var carritoExistente = snapshot.val();\n          var carritoArray = [];\n          if (Array.isArray(carritoExistente)) {\n            carritoArray = carritoExistente;\n          } else if (typeof carritoExistente === 'object') {\n            carritoArray = Object.values(carritoExistente);\n          }\n          carritoArray.push(newItem);\n          set(_carrito, carritoArray);\n        } else {\n          var nuevoCarrito = [newItem];\n          set(_carrito, nuevoCarrito);\n        }\n      });\n    }\n  };\n  var AgregarAlCarritoConVariante = function AgregarAlCarritoConVariante(item, opcion) {\n    var nombreCategoriaCarrito = \"Carritos/\" + `CarritoMesa${mesaNumber}`;\n    var carrito = sRef(database, nombreCategoriaCarrito);\n    var newItem = {\n      nombre: item.nombre,\n      precio: item.precio,\n      variante: opcion\n    };\n    get(carrito).then(function (snapshot) {\n      if (snapshot.exists()) {\n        var carritoExistente = snapshot.val();\n        var carritoArray = [];\n        if (Array.isArray(carritoExistente)) {\n          carritoArray = carritoExistente;\n        } else if (typeof carritoExistente === 'object') {\n          carritoArray = Object.values(carritoExistente);\n        }\n        carritoArray.push(newItem);\n        set(carrito, carritoArray);\n      } else {\n        var nuevoCarrito = [newItem];\n        set(carrito, nuevoCarrito);\n      }\n    });\n    setShowOptionsModal(false);\n  };\n  function desplegar() {\n    if (altura < '20%') {\n      setAltura('60%');\n      setDisplay(\"flex\");\n      setFlecha(\"▼\");\n    } else {\n      setAltura('10%');\n      setDisplay(\"none\");\n      setFlecha(\"▲\");\n    }\n  }\n  var EnviarAlChef = function EnviarAlChef() {\n    var nombreCategoriaCarrito = \"Carritos/\" + `CarritoMesa${mesaNumber}`;\n    var carrito = sRef(database, nombreCategoriaCarrito);\n    get(carrito).then(function (snapshot) {\n      if (snapshot.exists()) {\n        var carritoPendiente = snapshot.val();\n        if (Array.isArray(carritoPendiente)) {\n          var elementosPendientes = carritoPendiente.filter(function (elemento) {\n            return !elemento.enviado;\n          });\n          if (elementosPendientes.length > 0) {\n            EnviarElementosAlChef(elementosPendientes);\n            var carritoActualizado = carritoPendiente.map(function (elemento) {\n              if (elementosPendientes.some(function (enviado) {\n                return enviado.id === elemento.id;\n              })) {\n                return _objectSpread(_objectSpread({}, elemento), {}, {\n                  enviado: true\n                });\n              }\n              return elemento;\n            });\n            set(carrito, carritoActualizado).then(function () {}).catch(function (error) {\n              console.error('Error al actualizar el carrito:', error);\n            });\n          } else {}\n        } else {\n          console.error('El carrito pendiente no es un array válido.');\n        }\n      } else {}\n    });\n  };\n  var EnviarElementosAlChef = function EnviarElementosAlChef(elementosPendientes) {\n    var chefRef = sRef(getDatabase(), 'comandas');\n    var pedidoAlChef = {\n      elementos: elementosPendientes,\n      mesa: mesaNumber,\n      hora: new Date().toISOString()\n    };\n    push(chefRef, pedidoAlChef).then(function () {}).catch(function (error) {\n      console.error('Error al enviar el pedido al chef:', error);\n    });\n  };\n  var cerrarMesa = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      var carritoSnapshot = yield get(carrito);\n      if (carritoSnapshot.exists()) {\n        var carritoData = carritoSnapshot.val();\n        try {\n          yield remove(carrito);\n        } catch (error) {\n          console.error('Error al cerrar el carrito:', error);\n        }\n        var mesascerradasRef = sRef(database, \"Mesascerradas/\" + `Mesa${mesaNumber}cerrada`);\n        var mesacerrada = {\n          mozo: nombre,\n          mesa: mesaNumber,\n          carrito: carritoData\n        };\n        push(mesascerradasRef, mesacerrada);\n        var contadorRef = sRef(database, 'Infomozos/' + `Mesascerradas${nombre}`);\n        try {\n          var contadorSnapshot = yield get(contadorRef);\n          var contadorActual = contadorSnapshot.val() || 0;\n          yield set(contadorRef, contadorActual + 1);\n        } catch (error) {\n          console.error('Error al actualizar el contador de mesas cerradas:', error);\n        }\n      } else {}\n    });\n    return function cerrarMesa() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var agruparElementosPorNombreYVariante = function agruparElementosPorNombreYVariante(elementos) {\n    var agrupados = {};\n    elementos.forEach(function (elemento) {\n      var key = `${elemento.nombre}-${elemento.variante || ''}`;\n      if (agrupados[key]) {\n        agrupados[key].cantidad++;\n      } else {\n        agrupados[key] = _objectSpread(_objectSpread({}, elemento), {}, {\n          cantidad: 1\n        });\n      }\n    });\n    return Object.values(agrupados);\n  };\n  var closeModal = function closeModal() {\n    setShowOptionsModal(false);\n  };\n  var ModalComponent = function ModalComponent(_ref5) {\n    var visible = _ref5.visible,\n      onClose = _ref5.onClose,\n      opciones = _ref5.opciones,\n      item = _ref5.item;\n    if (!visible) return null;\n    return _jsx(Modal, {\n      visible: visible,\n      animationType: \"slide\",\n      children: _jsx(View, {\n        style: {\n          justifyContent: 'center',\n          alignItems: 'center'\n        },\n        children: _jsxs(View, {\n          style: {\n            backgroundColor: 'white',\n            padding: 10,\n            borderRadius: 10,\n            borderColor: 'black',\n            borderWidth: 1\n          },\n          children: [_jsx(Text, {\n            style: {\n              fontSize: 15,\n              fontWeight: 'bold',\n              textAlign: \"center\"\n            },\n            children: \"elige una opcion:\"\n          }), opciones ? opciones.map(function (opcion, index) {\n            return _jsx(TouchableOpacity, {\n              onPress: function onPress() {\n                return AgregarAlCarritoConVariante(item, opcion.nombre);\n              },\n              children: _jsx(Text, {\n                children: opcion.nombre\n              })\n            }, index);\n          }) : null, _jsx(Button, {\n            title: \"Cerrar\",\n            onPress: onClose\n          })]\n        })\n      })\n    });\n  };\n  return _jsxs(View, {\n    style: styles.white,\n    children: [_jsx(Text, {\n      style: styles.title,\n      children: subcategoria\n    }), _jsx(FlatList, {\n      style: {\n        height: \"100%\"\n      },\n      data: menuItems,\n      keyExtractor: function keyExtractor(item) {\n        return item.id.toString();\n      },\n      renderItem: function renderItem(_ref6) {\n        var item = _ref6.item;\n        return item.nombre || item.precio ? _jsx(TouchableHighlight, {\n          onPress: function onPress() {\n            return AgregarAlCarrito(item);\n          },\n          underlayColor: \"#6CCCFC\",\n          style: {\n            alignItems: \"center\",\n            padding: 10,\n            borderColor: 'black',\n            borderWidth: 1,\n            margin: 10\n          },\n          children: _jsxs(View, {\n            children: [_jsx(Text, {\n              children: item.nombre\n            }), _jsxs(Text, {\n              children: [\"Precio: $\", item.precio]\n            }), _jsx(Text, {\n              style: {\n                fontWeight: 'bold',\n                color: \"#00469B\"\n              },\n              children: \"Agregar al pedido\"\n            })]\n          })\n        }) : null;\n      }\n    }), _jsxs(View, {\n      style: {\n        height: altura,\n        backgroundColor: '#6CADFC',\n        alignContent: 'center'\n      },\n      children: [_jsxs(Text, {\n        id: \"desplegame\",\n        style: styles.title,\n        onPress: function onPress() {\n          return desplegar();\n        },\n        children: [flecha, \" Orden de la mesa \", flecha]\n      }), _jsxs(View, {\n        style: {\n          display: display\n        },\n        children: [_jsx(Text, {\n          style: {\n            textAlign: \"center\",\n            fontSize: 24,\n            fontWeight: 'bold',\n            marginBottom: 20\n          },\n          children: pedido ? 'Pedido:' : 'El pedido está vacío'\n        }), _jsxs(ScrollView, {\n          style: {\n            height: '30%'\n          },\n          children: [agruparElementosPorNombreYVariante(elementosEnviados).map(function (item, index) {\n            return _jsxs(Text, {\n              style: {\n                textAlign: 'center',\n                backgroundColor: '#6CFC7B'\n              },\n              children: [item.nombre, item.variante ? `${item.variante}` : '', \" X\", item.cantidad]\n            }, index);\n          }), agruparElementosPorNombreYVariante(elementosNoEnviados).map(function (item, index) {\n            return _jsxs(Text, {\n              style: {\n                textAlign: 'center',\n                backgroundColor: '#FC6C6C'\n              },\n              children: [item.nombre, item.variante ? `${item.variante}` : '', \" X\", item.cantidad]\n            }, index);\n          })]\n        }), _jsxs(View, {\n          style: {\n            alignItems: \"center\"\n          },\n          children: [_jsx(TouchableOpacity, {\n            onPress: function onPress() {\n              return EnviarAlChef();\n            },\n            style: {\n              backgroundColor: 'white',\n              width: \"30%\",\n              height: \"20%\",\n              borderRadius: \"15\",\n              justifyContent: \"center\",\n              marginTop: \"5%\"\n            },\n            children: _jsx(Text, {\n              style: {\n                textAlign: \"center\"\n              },\n              children: \"Enviar\"\n            })\n          }), _jsx(TouchableOpacity, {\n            onPress: function onPress() {\n              return cerrarMesa(nombre, mesaNumber);\n            },\n            style: {\n              backgroundColor: 'white',\n              width: \"30%\",\n              height: \"22%\",\n              borderRadius: \"15\",\n              justifyContent: \"center\",\n              marginTop: \"5%\"\n            },\n            children: _jsx(Text, {\n              style: {\n                textAlign: \"center\"\n              },\n              children: \"Cerrar la mesa\"\n            })\n          })]\n        })]\n      })]\n    }), _jsx(ModalComponent, {\n      visible: showOptionsModal,\n      onClose: closeModal,\n      opciones: selectedItem == null ? void 0 : selectedItem.opciones,\n      item: selectedItem\n    })]\n  });\n}\nvar styles = {\n  white: {\n    backgroundColor: 'white'\n  },\n  container: {\n    alignItems: 'center',\n    marginTop: '20%',\n    marginBottom: '10%'\n  },\n  mesas: {\n    height: 'auto',\n    justifyContent: 'center',\n    flexDirection: 'row',\n    flexWrap: 'wrap'\n  },\n  title: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    marginBottom: 16,\n    textAlign: \"center\"\n  },\n  boton: {\n    width: 200,\n    height: 50,\n    backgroundColor: '#6CCCFC',\n    margin: 10,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  botontable: {\n    width: 100,\n    height: 100,\n    borderRadius: '20',\n    backgroundColor: '#6CCCFC',\n    margin: 10,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  botontext: {\n    color: 'white'\n  }\n};","map":{"version":3,"names":["React","useState","useEffect","View","Text","Button","ScrollView","TouchableOpacity","TouchableHighlight","FlatList","ScrollViewBase","getDatabase","onValue","off","push","get","set","remove","NavigationContainer","useNavigation","useRoute","createNativeStackNavigator","FirebaseApp","initializeApp","ref","sRef","Modal","Portal","PaperButton","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","_ref","nombre","_useState","_useState2","_slicedToArray","altura","setAltura","_useState3","_useState4","display","setDisplay","_useState5","_useState6","flecha","setFlecha","_useState7","_useState8","pedido","setPedido","independent","children","Stack","Navigator","Screen","name","component","MozoPage","options","headerShown","initialParams","ElegirMenu","Subcategoria","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","app","database","infoRef","_useState9","_useState10","mesas","setMesas","_useState11","_useState12","cantidadmesas","setCantidadMesas","navigation","route","params","unsubscribe","snapshot","exists","data","val","infoItems","Object","values","Array","fill","handleMesaPress","mesaNumber","navigate","style","styles","container","title","contentContainerStyle","map","_","index","onPress","botontable","menu","_useState13","_useState14","subcategorias","setSubcategorias","comidaRef","_useState15","_useState16","elementosNoEnviados","setElementosNoEnviados","_useState17","_useState18","elementosEnviados","setElementosEnviados","carrito","elementos","filter","elemento","enviado","unsubscrib","subcategoriasArray","keys","nombreCategoriaCarrito","EnviarAlChef","then","carritoPendiente","isArray","elementosPendientes","length","EnviarElementosAlChef","carritoActualizado","some","id","_objectSpread","catch","error","console","agruparElementosPorNombreYVariante","agrupados","forEach","key","variante","cantidad","chefRef","pedidoAlChef","mesa","hora","Date","toISOString","cerrarMesa","_ref2","_asyncToGenerator","carritoSnapshot","carritoData","mesascerradasRef","mesacerrada","mozo","contadorRef","contadorSnapshot","contadorActual","apply","arguments","desplegar","backgroundColor","height","subcategoria","boton","botontext","alignContent","textAlign","fontSize","fontWeight","marginBottom","item","alignItems","width","borderRadius","justifyContent","marginTop","_ref3","_route$params","_useState19","_useState20","menuItems","setMenuItems","_useState21","_useState22","showOptionsModal","setShowOptionsModal","_useState23","_useState24","selectedItem","setSelectedItem","subcategoriaRef","AgregarAlCarrito","opciones","newItem","precio","carritoExistente","carritoArray","nuevoCarrito","AgregarAlCarritoConVariante","opcion","_ref4","closeModal","ModalComponent","_ref5","visible","onClose","animationType","padding","borderColor","borderWidth","white","keyExtractor","toString","renderItem","_ref6","underlayColor","margin","color","flexDirection","flexWrap"],"sources":["C:/Users/octal/OneDrive/Documentos/Diseño web/proyectos/calm-apples/calm-apples/Components/Mozo.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { View, Text, Button, ScrollView, TouchableOpacity, TouchableHighlight, FlatList, ScrollViewBase } from 'react-native';\r\nimport { getDatabase, onValue, off, push, get, set, remove } from \"firebase/database\";\r\nimport { NavigationContainer, useNavigation, useRoute } from '@react-navigation/native';\r\nimport { createNativeStackNavigator } from '@react-navigation/native-stack';\r\nimport { FirebaseApp, initializeApp } from \"firebase/app\";\r\nimport { ref as sRef} from \"firebase/database\";\r\nimport { Modal, Portal, Button as PaperButton } from 'react-native-paper';\r\n\r\n\r\n\r\nexport default function App({ nombre }) {\r\n      const [altura, setAltura] = useState('10%');\r\n  const [display, setDisplay] = useState('none');\r\n  const [flecha, setFlecha] = useState('▲');\r\n  const [pedido, setPedido] = useState(null);\r\n    return (\r\n        <NavigationContainer independent={true}>\r\n            <Stack.Navigator>\r\n                <Stack.Screen\r\n                name=\"TableS\"\r\n                component={MozoPage}\r\n                options={{ headerShown: false }}\r\n                initialParams={{ nombre: nombre }}\r\n                />\r\n                <Stack.Screen\r\n                name=\"elegirmenu\"\r\n                component={ElegirMenu}\r\n                options={{ headerShown: false }}\r\n                />\r\n                <Stack.Screen\r\n                name=\"subcategoria\"\r\n                component={Subcategoria}\r\n                options={{ headerShown: false }}\r\n                />\r\n        </Stack.Navigator>\r\n        </NavigationContainer>\r\n    );\r\n}\r\n\r\nconst firebaseConfig = {\r\n    apiKey: \"AIzaSyBZoCJQgmwqXltZbBWmkZ54stBlT6jf4Gs\",\r\n    authDomain: \"restoapp-2e79a.firebaseapp.com\",\r\n    databaseURL: \"https://restoapp-2e79a-default-rtdb.firebaseio.com\",\r\n    projectId: \"restoapp-2e79a\",\r\n    storageBucket: \"restoapp-2e79a.appspot.com\",\r\n    messagingSenderId: \"300896535259\",\r\n    appId: \"1:300896535259:web:33f41bd2627b410064c2fe\",\r\n    measurementId: \"G-X9RC5LH6MK\"\r\n};\r\n\r\nconst app: FirebaseApp = initializeApp(firebaseConfig);\r\n\r\nconst database = getDatabase(app);\r\n\r\nconst Stack = createNativeStackNavigator();\r\n\r\n\r\nfunction MozoPage() {\r\n  const infoRef = sRef(database, 'info');\r\n  const [mesas, setMesas] = useState([]); // Aquí guardaremos el número de mesas\r\n  const [cantidadmesas, setCantidadMesas] = useState(null); // Declarar cantidadmesas\r\n  const navigation = useNavigation();\r\n  const route = useRoute();\r\n  const nombre = route.params.nombre\r\n  \r\n  useEffect(() => {\r\n    const unsubscribe = onValue(infoRef, (snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const data = snapshot.val();\r\n        const infoItems = Object.values(data);\r\n        const cantidadmesas = infoItems[0]\r\n  \r\n        setMesas(new Array(cantidadmesas).fill(null));\r\n        setCantidadMesas(cantidadmesas);\r\n      } else {\r\n        setMesas([]);\r\n      }\r\n    }, []); // Aquí, pasamos un array de dependencias vacío\r\n  }, []);\r\n\r\n  const handleMesaPress = (mesaNumber) => {\r\n    // Navegar a la página deseada y pasar el número de mesa como parámetro\r\n    navigation.navigate('elegirmenu', { mesaNumber, nombre });\r\n  };\r\n\r\n  return (\r\n    <>\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>Seleccione una mesa:</Text>\r\n      </View>\r\n    <ScrollView contentContainerStyle={styles.mesas}>\r\n      {cantidadmesas !== null && (\r\n        mesas.map((_, index) => (\r\n          <TouchableOpacity key={index} onPress={() => handleMesaPress(index + 1)} style={styles.botontable}>\r\n            <Text>Mesa {index + 1}</Text>\r\n          </TouchableOpacity>\r\n        ))\r\n      )}\r\n    </ScrollView>\r\n    </>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\nfunction ElegirMenu() {\r\n  const route = useRoute(); // Obtén el objeto de ruta\r\n  const nombre = route.params.nombre\r\n  const menu = sRef(database);\r\n  const navigation = useNavigation();\r\n  const [subcategorias, setSubcategorias] = useState([]);\r\n  const comidaRef = sRef(getDatabase(), 'Comida');\r\n\r\n   const [elementosNoEnviados, setElementosNoEnviados] = useState([]);\r\n  const [elementosEnviados, setElementosEnviados] = useState([]);\r\n\r\n  useEffect(() => {\r\n    onValue(carrito, (snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const pedido = snapshot.val();\r\n        const elementos = Object.values(pedido);\r\n\r\n        // Separa los elementos en \"enviados\" y \"no enviados\"\r\n        const elementosNoEnviados = elementos.filter((elemento) => !elemento.enviado);\r\n        const elementosEnviados = elementos.filter((elemento) => elemento.enviado);\r\n\r\n        setElementosNoEnviados(elementosNoEnviados);\r\n        setElementosEnviados(elementosEnviados);\r\n      } else {\r\n        setElementosNoEnviados([]);\r\n        setElementosEnviados([]);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const unsubscrib = onValue(comidaRef, (snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const data = snapshot.val();\r\n        // Obtener las subcategorías dentro de \"Comida\" como un array de nombres\r\n        const subcategoriasArray = Object.keys(data);\r\n        setSubcategorias(subcategoriasArray);\r\n      } else {\r\n        setSubcategorias([]);\r\n      }\r\n    });\r\n  }, []); // Asegúrate de pasar un array de dependencias vacío\r\n  \r\n\r\n  const { mesaNumber } = route.params; // Extrae el número de mesa de los parámetros\r\n\r\n  const nombreCategoriaCarrito = \"Carritos/\" + `CarritoMesa${mesaNumber}`;\r\n  const carrito = sRef(database, nombreCategoriaCarrito);\r\n\r\n  \r\n\r\n  useEffect(() => {\r\n  onValue(carrito, (snapshot) => {\r\n    if (snapshot.exists()) {\r\n      const pedido = snapshot.val();\r\n      setPedido(pedido);\r\n    } else {\r\n\r\n      setPedido(null);\r\n    }\r\n  });\r\n}, []);\r\n\r\n\r\n\r\nconst EnviarAlChef = () => {\r\n  const nombreCategoriaCarrito = \"Carritos/\" + `CarritoMesa${mesaNumber}`;\r\n  const carrito = sRef(database, nombreCategoriaCarrito);\r\n\r\n  get(carrito).then((snapshot) => {\r\n    if (snapshot.exists()) {\r\n      const carritoPendiente = snapshot.val();\r\n\r\n      // Verifica si el carrito pendiente es un array\r\n      if (Array.isArray(carritoPendiente)) {\r\n        // Filtra los elementos pendientes\r\n        const elementosPendientes = carritoPendiente.filter((elemento) => !elemento.enviado);\r\n\r\n        if (elementosPendientes.length > 0) {\r\n          EnviarElementosAlChef(elementosPendientes);\r\n\r\n          // Marca los elementos enviados en el carrito pendiente\r\n          const carritoActualizado = carritoPendiente.map((elemento) => {\r\n            if (elementosPendientes.some((enviado) => enviado.id === elemento.id)) {\r\n              return { ...elemento, enviado: true };\r\n            }\r\n            return elemento;\r\n          });\r\n\r\n          // Actualiza el carrito en la base de datos con los elementos pendientes\r\n          set(carrito, carritoActualizado)\r\n            .then(() => {\r\n            })\r\n            .catch((error) => {\r\n              console.error('Error al actualizar el carrito:', error);\r\n            });\r\n        } else {\r\n        }\r\n      } else {\r\n        console.error('El carrito pendiente no es un array válido.');\r\n      }\r\n    } else {\r\n    }\r\n  });\r\n};\r\n\r\nconst agruparElementosPorNombreYVariante = (elementos) => {\r\n  const agrupados = {};\r\n\r\n  elementos.forEach((elemento) => {\r\n    const key = `${elemento.nombre}-${elemento.variante || ''}`;\r\n    if (agrupados[key]) {\r\n      agrupados[key].cantidad++;\r\n    } else {\r\n      agrupados[key] = { ...elemento, cantidad: 1 };\r\n    }\r\n  });\r\n\r\n  return Object.values(agrupados);\r\n};\r\n\r\nconst EnviarElementosAlChef = (elementosPendientes) => {\r\n  const chefRef = sRef(getDatabase(), 'comandas');\r\n\r\n  const pedidoAlChef = {\r\n    elementos: elementosPendientes, // Los elementos pendientes\r\n    mesa: mesaNumber, // El número de mesa\r\n    hora: new Date().toISOString(), // Marca de tiempo del pedido\r\n  };\r\n\r\n  push(chefRef, pedidoAlChef)\r\n    .then(() => {\r\n    })\r\n    .catch((error) => {\r\n      console.error('Error al enviar el pedido al chef:', error);\r\n    });\r\n};\r\n\r\n\r\nconst cerrarMesa = async () => {\r\n\r\n  const carritoSnapshot = await get(carrito);\r\n  if (carritoSnapshot.exists()) {\r\n    const carritoData = carritoSnapshot.val();\r\n  try {\r\n    await remove(carrito);\r\n  } catch (error) {\r\n    console.error('Error al cerrar el carrito:', error);\r\n  }\r\n\r\n  const mesascerradasRef = sRef(database, \"Mesascerradas/\" + `Mesa${mesaNumber}cerrada`)\r\n  const mesacerrada = {\r\n    mozo: nombre,\r\n    mesa: mesaNumber,\r\n    carrito: carritoData,\r\n  }\r\n\r\n  push(mesascerradasRef, mesacerrada)\r\n\r\n  // Incrementa el contador de mesas cerradas\r\n  const contadorRef = sRef(database, 'Infomozos/' + `Mesascerradas${nombre}`);\r\n  try {\r\n    const contadorSnapshot = await get(contadorRef);\r\n    const contadorActual = contadorSnapshot.val() || 0;\r\n    await set(contadorRef, contadorActual + 1);\r\n  } catch (error) {\r\n    console.error('Error al actualizar el contador de mesas cerradas:', error);\r\n  }\r\n}\r\nelse {\r\n\r\n}}\r\n\r\n\r\n\r\n  function desplegar() {\r\n    if (altura < '20%') {\r\n    setAltura('60%');\r\n    setDisplay(\"flex\")\r\n    setFlecha(\"▼\")\r\n  }\r\n  else {\r\n    setAltura('10%');\r\n    setDisplay(\"none\")\r\n    setFlecha(\"▲\")\r\n\r\n  }\r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <View style={{backgroundColor:\"white\", height:\"100%\"}}>\r\n    <View style={styles.container}>\r\n    <Text style={styles.title}>Pedido de la mesa {mesaNumber}</Text>\r\n    <Text>Menu:</Text>\r\n      </View>\r\n      <ScrollView contentContainerStyle={styles.mesas}>\r\n      {subcategorias.map((subcategoria, index) => (\r\n        <TouchableOpacity\r\n          key={index}\r\n          style={styles.boton}\r\n          onPress={() => {\r\n            // Navegar a la pantalla de la subcategoría seleccionada\r\n            navigation.navigate('subcategoria', { subcategoria, mesaNumber, nombre, elementosEnviados, elementosNoEnviados, pedido, setPedido});\r\n          } }\r\n        >\r\n          <Text style={styles.botontext}>{subcategoria}</Text>\r\n        </TouchableOpacity>\r\n      ))}\r\n    </ScrollView>\r\n    <View style={{height: altura, backgroundColor: '#6CADFC', alignContent: 'center', }}>\r\n    <Text id='desplegame' style={styles.title} onPress={() => desplegar()}>{flecha} Orden de la mesa {flecha}</Text>\r\n    <View style={{display: display,}}>\r\n    <Text style={{textAlign:\"center\", fontSize: 24,fontWeight: 'bold', marginBottom: 20,}}>{pedido ? 'Pedido:': 'El pedido está vacío'}</Text>\r\n    <ScrollView style={{ height: '30%' }}>\r\n          {agruparElementosPorNombreYVariante(elementosEnviados).map((item, index) => (\r\n            <Text\r\n              style={{ textAlign: 'center', backgroundColor: '#6CFC7B' }}\r\n              key={index}\r\n            >\r\n              {item.nombre}{item.variante ? `${item.variante}` : ''} X{item.cantidad}\r\n            </Text>\r\n          ))}\r\n          {agruparElementosPorNombreYVariante(elementosNoEnviados).map((item, index) => (\r\n            <Text\r\n              style={{ textAlign: 'center', backgroundColor: '#FC6C6C' }}\r\n              key={index}\r\n            >\r\n              {item.nombre}{item.variante ? `${item.variante}` : ''} X{item.cantidad}\r\n            </Text>\r\n          ))}\r\n        </ScrollView>\r\n    <View style={{alignItems:\"center\",}}>\r\n    <TouchableOpacity onPress={() => EnviarAlChef()} style={{backgroundColor: 'white', width:\"30%\", height:\"20%\", borderRadius:\"15\", justifyContent:\"center\", marginTop:\"5%\"}}><Text style={{textAlign:\"center\",}}>Enviar</Text></TouchableOpacity>\r\n    <TouchableOpacity onPress={() => cerrarMesa(nombre, mesaNumber)} style={{backgroundColor: 'white', width:\"30%\", height:\"22%\", borderRadius:\"15\", justifyContent:\"center\", marginTop:\"5%\"}}><Text style={{textAlign:\"center\",}}>Cerrar la mesa</Text></TouchableOpacity>\r\n    </View>\r\n    </View>\r\n    </View>\r\n    </View>\r\n  );\r\n}\r\n\r\n\r\n\r\nfunction Subcategoria({ route }) {\r\n  const { subcategoria, mesaNumber, nombre, elementosEnviados, elementosNoEnviados } = route.params;\r\n  const [menuItems, setMenuItems] = useState([]);\r\n  const [showOptionsModal, setShowOptionsModal] = useState(false);\r\n  const [selectedItem, setSelectedItem] = useState(null);\r\n\r\n  useEffect(() => {\r\n\r\n    const subcategoriaRef = sRef(getDatabase(), 'Comida/' + subcategoria);\r\n    const unsubscribe = onValue(subcategoriaRef, (snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const data = snapshot.val();\r\n        const elementos = Object.keys(data).map((key) => ({\r\n          id: key,\r\n          ...data[key],\r\n        }));\r\n        setMenuItems(elementos);\r\n      } else {\r\n        setMenuItems([]);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      unsubscribe();\r\n    };\r\n  }, [subcategoria]);\r\n\r\n  const AgregarAlCarrito = (item) => {\r\n\r\n\r\n    if (item.opciones) {\r\n\r\n      setSelectedItem(item);\r\n      setShowOptionsModal(true);\r\n\r\n    }\r\n    else {\r\n    const nombreCategoriaCarrito = \"Carritos/\" + `CarritoMesa${mesaNumber}`;\r\n    const carrito = sRef(database, nombreCategoriaCarrito);\r\n\r\n    onValue(carrito, (snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const pedido = snapshot.val();\r\n        setPedido(pedido);\r\n      } else {\r\n  \r\n        setPedido(null);\r\n      }\r\n    });\r\n\r\n    const newItem = {\r\n      nombre: item.nombre,\r\n      precio: item.precio,\r\n    };\r\n\r\n    get(carrito).then((snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const carritoExistente = snapshot.val();\r\n        let carritoArray = [];\r\n\r\n        if (Array.isArray(carritoExistente)) {\r\n          carritoArray = carritoExistente;\r\n        } else if (typeof carritoExistente === 'object') {\r\n          carritoArray = Object.values(carritoExistente);\r\n        }\r\n\r\n        carritoArray.push(newItem);\r\n        set(carrito, carritoArray);\r\n      } else {\r\n        const nuevoCarrito = [newItem];\r\n        set(carrito, nuevoCarrito);\r\n      }\r\n    });\r\n  }\r\n  };\r\n\r\n  const AgregarAlCarritoConVariante = (item, opcion) => {\r\n    const nombreCategoriaCarrito = \"Carritos/\" + `CarritoMesa${mesaNumber}`;\r\n    const carrito = sRef(database, nombreCategoriaCarrito);\r\n\r\n    const newItem = {\r\n      nombre: item.nombre,\r\n      precio: item.precio,\r\n      variante: opcion,\r\n    };\r\n\r\n    get(carrito).then((snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const carritoExistente = snapshot.val();\r\n        let carritoArray = [];\r\n\r\n        if (Array.isArray(carritoExistente)) {\r\n          carritoArray = carritoExistente;\r\n        } else if (typeof carritoExistente === 'object') {\r\n          carritoArray = Object.values(carritoExistente);\r\n        }\r\n\r\n        carritoArray.push(newItem);\r\n        set(carrito, carritoArray);\r\n      } else {\r\n        const nuevoCarrito = [newItem];\r\n        set(carrito, nuevoCarrito);\r\n      }\r\n    });\r\n    setShowOptionsModal(false);\r\n  };\r\n\r\n\r\n  function desplegar() {\r\n    if (altura < '20%') {\r\n    setAltura('60%');\r\n    setDisplay(\"flex\")\r\n    setFlecha(\"▼\")\r\n  }\r\n  else {\r\n    setAltura('10%');\r\n    setDisplay(\"none\")\r\n    setFlecha(\"▲\")\r\n\r\n  }\r\n  }\r\n\r\n  const EnviarAlChef = () => {\r\n    const nombreCategoriaCarrito = \"Carritos/\" + `CarritoMesa${mesaNumber}`;\r\n    const carrito = sRef(database, nombreCategoriaCarrito);\r\n  \r\n    get(carrito).then((snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const carritoPendiente = snapshot.val();\r\n  \r\n        // Verifica si el carrito pendiente es un array\r\n        if (Array.isArray(carritoPendiente)) {\r\n          // Filtra los elementos pendientes\r\n          const elementosPendientes = carritoPendiente.filter((elemento) => !elemento.enviado);\r\n  \r\n          if (elementosPendientes.length > 0) {\r\n            EnviarElementosAlChef(elementosPendientes);\r\n  \r\n            // Marca los elementos enviados en el carrito pendiente\r\n            const carritoActualizado = carritoPendiente.map((elemento) => {\r\n              if (elementosPendientes.some((enviado) => enviado.id === elemento.id)) {\r\n                return { ...elemento, enviado: true };\r\n              }\r\n              return elemento;\r\n            });\r\n  \r\n            // Actualiza el carrito en la base de datos con los elementos pendientes\r\n            set(carrito, carritoActualizado)\r\n              .then(() => {\r\n              })\r\n              .catch((error) => {\r\n                console.error('Error al actualizar el carrito:', error);\r\n              });\r\n          } else {\r\n          }\r\n        } else {\r\n          console.error('El carrito pendiente no es un array válido.');\r\n        }\r\n      } else {\r\n      }\r\n    });\r\n  };\r\n\r\n  const EnviarElementosAlChef = (elementosPendientes) => {\r\n    const chefRef = sRef(getDatabase(), 'comandas');\r\n  \r\n    const pedidoAlChef = {\r\n      elementos: elementosPendientes, // Los elementos pendientes\r\n      mesa: mesaNumber, // El número de mesa\r\n      hora: new Date().toISOString(), // Marca de tiempo del pedido\r\n    };\r\n  \r\n    push(chefRef, pedidoAlChef)\r\n      .then(() => {\r\n      })\r\n      .catch((error) => {\r\n        console.error('Error al enviar el pedido al chef:', error);\r\n      });\r\n  };\r\n  \r\n  \r\n  const cerrarMesa = async () => {\r\n  \r\n    const carritoSnapshot = await get(carrito);\r\n    if (carritoSnapshot.exists()) {\r\n      const carritoData = carritoSnapshot.val();\r\n    try {\r\n      await remove(carrito);\r\n    } catch (error) {\r\n      console.error('Error al cerrar el carrito:', error);\r\n    }\r\n  \r\n    const mesascerradasRef = sRef(database, \"Mesascerradas/\" + `Mesa${mesaNumber}cerrada`)\r\n    const mesacerrada = {\r\n      mozo: nombre,\r\n      mesa: mesaNumber,\r\n      carrito: carritoData,\r\n    }\r\n  \r\n    push(mesascerradasRef, mesacerrada)\r\n  \r\n    // Incrementa el contador de mesas cerradas\r\n    const contadorRef = sRef(database, 'Infomozos/' + `Mesascerradas${nombre}`);\r\n    try {\r\n      const contadorSnapshot = await get(contadorRef);\r\n      const contadorActual = contadorSnapshot.val() || 0;\r\n      await set(contadorRef, contadorActual + 1);\r\n    } catch (error) {\r\n      console.error('Error al actualizar el contador de mesas cerradas:', error);\r\n    }\r\n  }\r\n  else {\r\n  \r\n  }}\r\n\r\n\r\n\r\n  const agruparElementosPorNombreYVariante = (elementos) => {\r\n    const agrupados = {};\r\n  \r\n    elementos.forEach((elemento) => {\r\n      const key = `${elemento.nombre}-${elemento.variante || ''}`;\r\n      if (agrupados[key]) {\r\n        agrupados[key].cantidad++;\r\n      } else {\r\n        agrupados[key] = { ...elemento, cantidad: 1 };\r\n      }\r\n    });\r\n  \r\n    return Object.values(agrupados);\r\n  };\r\n\r\n\r\n  const closeModal = () => {\r\n    setShowOptionsModal(false);\r\n  };\r\n\r\n  const ModalComponent = ({ visible, onClose, opciones, item }) => {\r\n    if (!visible) return null;\r\n  \r\n    return (\r\n      <Modal visible={visible} animationType=\"slide\">\r\n        <View style={{justifyContent: 'center', alignItems: 'center',}}>\r\n          <View style={{ backgroundColor: 'white', padding: 10, borderRadius: 10, borderColor: 'black', borderWidth: 1, }}>\r\n            <Text style={{fontSize: 15, fontWeight: 'bold', textAlign:\"center\"}}>elige una opcion:</Text>\r\n            {opciones ? (\r\n              opciones.map((opcion, index) => (\r\n                <TouchableOpacity key={index} onPress={() => AgregarAlCarritoConVariante(item, opcion.nombre)}><Text>{opcion.nombre}</Text></TouchableOpacity>\r\n              ))\r\n            ) : null}\r\n            <Button title=\"Cerrar\" onPress={onClose} />\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={styles.white}>\r\n      <Text style={styles.title}>{subcategoria}</Text>\r\n        <FlatList\r\n          style={{height:\"100%\"}}\r\n          data={menuItems}\r\n          keyExtractor={(item) => item.id.toString()}\r\n          renderItem={({ item }) => (\r\n            item.nombre || item.precio ? (\r\n            <TouchableHighlight onPress={() => AgregarAlCarrito(item)} underlayColor=\"#6CCCFC\" style={{ alignItems: \"center\", padding: 10, borderColor: 'black', borderWidth: 1, margin: 10 }}>\r\n            <View >\r\n              <Text>{item.nombre}</Text>\r\n              <Text>Precio: ${item.precio}</Text>\r\n              <Text style={{fontWeight: 'bold', color:\"#00469B\"}}>Agregar al pedido</Text>\r\n            </View>\r\n            </TouchableHighlight>\r\n            ) : null\r\n          )}\r\n        />\r\n          <View style={{height: altura, backgroundColor: '#6CADFC', alignContent: 'center', }}>\r\n    <Text id='desplegame' style={styles.title} onPress={() => desplegar()}>{flecha} Orden de la mesa {flecha}</Text>\r\n    <View style={{display: display,}}>\r\n    <Text style={{textAlign:\"center\", fontSize: 24,fontWeight: 'bold', marginBottom: 20,}}>{pedido ? 'Pedido:': 'El pedido está vacío'}</Text>\r\n    <ScrollView style={{ height: '30%' }}>\r\n          {agruparElementosPorNombreYVariante(elementosEnviados).map((item, index) => (\r\n            <Text\r\n              style={{ textAlign: 'center', backgroundColor: '#6CFC7B' }}\r\n              key={index}\r\n            >\r\n              {item.nombre}{item.variante ? `${item.variante}` : ''} X{item.cantidad}\r\n            </Text>\r\n          ))}\r\n          {agruparElementosPorNombreYVariante(elementosNoEnviados).map((item, index) => (\r\n            <Text\r\n              style={{ textAlign: 'center', backgroundColor: '#FC6C6C' }}\r\n              key={index}\r\n            >\r\n              {item.nombre}{item.variante ? `${item.variante}` : ''} X{item.cantidad}\r\n            </Text>\r\n          ))}\r\n        </ScrollView>\r\n    <View style={{alignItems:\"center\",}}>\r\n    <TouchableOpacity onPress={() => EnviarAlChef()} style={{backgroundColor: 'white', width:\"30%\", height:\"20%\", borderRadius:\"15\", justifyContent:\"center\", marginTop:\"5%\"}}><Text style={{textAlign:\"center\",}}>Enviar</Text></TouchableOpacity>\r\n    <TouchableOpacity onPress={() => cerrarMesa(nombre, mesaNumber)} style={{backgroundColor: 'white', width:\"30%\", height:\"22%\", borderRadius:\"15\", justifyContent:\"center\", marginTop:\"5%\"}}><Text style={{textAlign:\"center\",}}>Cerrar la mesa</Text></TouchableOpacity>\r\n    </View>\r\n    </View>\r\n    </View>\r\n      <ModalComponent visible={showOptionsModal} onClose={closeModal} opciones={selectedItem?.opciones} item={selectedItem}/>\r\n    </View>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\nconst styles = {\r\n  white: {\r\n    backgroundColor: 'white',\r\n  },\r\n  container: {\r\n    alignItems: 'center',\r\n    marginTop: '20%',\r\n    marginBottom: '10%',\r\n    \r\n  },\r\n  mesas: {\r\n    height: 'auto',\r\n    justifyContent: 'center',\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap', \r\n  },\r\n  title: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    marginBottom: 16,\r\n    textAlign:\"center\",\r\n  },\r\n  boton: {\r\n    width: 200,\r\n    height: 50,\r\n    backgroundColor: '#6CCCFC',\r\n    margin: 10,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  botontable: {\r\n    width: 100,\r\n    height: 100,\r\n    borderRadius: '20',\r\n    backgroundColor: '#6CCCFC',\r\n    margin: 10,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  botontext: {\r\n    color: 'white',\r\n  },\r\n};\r\n\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}